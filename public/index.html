<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Scatterize 3</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<header class="site-header">
  <h1 class="site-title"><a href="./" class="site-title-link">Scatterize 3</a></h1>
  <div class="url-bar">
    <input
      type="text"
      id="source-url"
      class="url-input"
      placeholder="Paste a CSV or Google Sheets URL — or drop a file on the page"
      autocomplete="off"
      spellcheck="false"
    >
    <button id="load-btn" class="btn btn-primary">Load</button>
  </div>
</header>

<main id="app" class="app-grid">

  <aside class="panel panel-controls" id="panel-controls">
    <div class="control-group">
      <label for="x-select">X variable</label>
      <select id="x-select" class="form-select"></select>
    </div>
    <div class="control-group">
      <label for="y-select">Y variable</label>
      <select id="y-select" class="form-select"></select>
    </div>
    <div class="control-group">
      <label for="model-select">Model</label>
      <select id="model-select" class="form-select">
        <option value="ols">OLS</option>
        <option value="robust">Robust</option>
        <option value="spearman">Spearman</option>
        <option value="theilsen">Theil-Sen</option>
      </select>
    </div>
    <div class="control-group" id="nuisance-group">
      <label>Nuisance covariates</label>
      <div id="nuisance-list" class="checkbox-list"></div>
      <p class="control-note" id="nuisance-note" hidden>
        Not available for rank-based models.
      </p>
    </div>
    <div class="control-group">
      <label for="group-select">Group / color</label>
      <select id="group-select" class="form-select">
        <option value="">None</option>
      </select>
    </div>
  </aside>

  <div class="plot-container" id="plot-container">
    <svg id="scatter-svg" class="scatter-svg"></svg>
    <svg id="overlay-svg" class="overlay-svg"></svg>
    <div class="loading-state hidden" id="loading-state">
      <p id="loading-message">Loading data…</p>
    </div>
    <button id="share-btn" class="share-btn" aria-label="Share / Export">
      <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
        <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
      </svg>
      Share
    </button>
    <div class="empty-state" id="empty-state">
      <div class="empty-state-inner">
        <h3>No data loaded</h3>
        <p>Paste a link to a Google Sheet or CSV file in the bar above and click Load.</p>
        <p>Also accepts GitHub file and Gist URLs.</p>
        <p>Or drop a CSV file anywhere on the page.</p>
        <p>Everything runs in your browser; no data is sent to our server.</p>
        <p>Don't believe us? <a href="https://github.com/njvack/scatterize/releases">Download a copy</a> and run it on your computer.</p>
        <p>Just want to see some data? Check out:
          <ul>
            <li><a href="https://njvack.github.io/scatterize/#src=https%3A%2F%2Fgist.github.com%2Fnjvack%2Fb7817275dcca4bca02bff5429ef29a3c&x=0&y=1&m=ols">Anscombe's Quartet</a></li>
            <li><a href="https://njvack.github.io/scatterize/#src=https%3A%2F%2Fgist.github.com%2Fnjvack%2Fcd9cb7c71542b056afa859eea36d7850&x=3&y=0&m=ols">The mtcars database</a></li>
          </ul>
        </p>
      </div>
    </div>
  </div>

  <aside class="panel panel-stats" id="panel-stats">
    <div id="stats-model" class="stats-section stats-section--model"></div>
    <div id="stats-desc" class="stats-section stats-section--desc"></div>
    <div id="diag-plots" class="diag-plots">
      <h3>Diagnostics</h3>
      <div class="diag-svg-container">
        <svg id="diag-combined" class="diag-svg" style="height:150px"></svg>
        <svg id="diag-overlay" class="overlay-svg"></svg>
      </div>
    </div>
  </aside>

</main>

<footer class="site-footer">
  <button id="help-btn" class="footer-link">Keyboard shortcuts</button>
  <span class="footer-sep">·</span>
  <a href="https://github.com/njvack/scatterize" class="footer-link">About</a>
  <span class="footer-sep">·</span>
  <a href="https://github.com/njvack/scatterize/issues" class="footer-link">Feedback</a>
  <span class="footer-sep">·</span>
  <a href="https://www.theleagueofmoveabletype.com/league-spartan" class="footer-link">League Spartan</a>
</footer>

<dialog id="help-modal">
  <p class="help-modal-title">Keyboard shortcuts</p>
  <table class="help-table">
    <tr><td><kbd>j</kbd> / <kbd>k</kbd></td><td>Next / previous Y variable</td></tr>
    <tr><td><kbd>u</kbd> / <kbd>i</kbd></td><td>Previous / next X variable</td></tr>
    <tr><td><kbd>o</kbd> / <kbd>p</kbd></td><td>Previous / next model</td></tr>
    <tr><td><kbd>c</kbd></td><td>Clear censored points</td></tr>
    <tr><td><kbd>?</kbd></td><td>Show / hide this help</td></tr>
  </table>
  <p class="help-modal-dismiss">Press <kbd>?</kbd> or <kbd>Esc</kbd> to close</p>
</dialog>

<dialog id="share-modal">
  <section class="share-section">
    <h3>Export SVG</h3>
    <div class="share-download-row">
      <input id="svg-filename" type="text" class="share-filename-input">
      <button id="svg-download-btn" class="btn btn-secondary">Download</button>
    </div>
    <div class="share-download-row" id="svg-diag-row" hidden>
      <input id="svg-diag-filename" type="text" class="share-filename-input">
      <button id="svg-diag-download-btn" class="btn btn-secondary">Download</button>
    </div>
  </section>
  <section class="share-section">
    <h3>Export PNG</h3>
    <div class="share-download-row">
      <input id="png-filename" type="text" class="share-filename-input">
      <button id="png-download-btn" class="btn btn-secondary">Download</button>
    </div>
    <div class="share-download-row" id="png-diag-row" hidden>
      <input id="png-diag-filename" type="text" class="share-filename-input">
      <button id="png-diag-download-btn" class="btn btn-secondary">Download</button>
    </div>
  </section>
  <section class="share-section">
    <h3>Share URL</h3>
    <div class="share-download-row">
      <input id="share-url" type="text" class="share-filename-input" readonly>
      <button id="copy-url-btn" class="btn btn-secondary">Copy</button>
    </div>
    <p class="share-url-note" id="local-note" hidden>Not available for local files.</p>
  </section>
</dialog>

<div class="error-banner" id="error-banner" hidden>
  <span id="error-message"></span>
  <button class="error-close" id="error-close" aria-label="Dismiss">×</button>
</div>

<div class="drop-overlay" id="drop-overlay" aria-hidden="true">
  <div class="drop-overlay-inner">
    <p class="drop-message">Drop CSV file to load</p>
  </div>
</div>

<script src="dist/main.js"></script>
</body>
</html>
